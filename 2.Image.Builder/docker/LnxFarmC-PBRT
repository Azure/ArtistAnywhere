FROM xstudio.azurecr.io/lnx-farm-c:cmake

WORKDIR /usr/local/src

RUN dnf -y install mesa-libGL-devel &&\
    dnf -y install libXrandr-devel &&\
    dnf -y install libXinerama-devel &&\
    dnf -y install libXcursor-devel &&\
    dnf -y install libXi-devel

RUN source /usr/local/src/functions.sh &&\
    git clone --recursive https://github.com/mmp/pbrt-v4.git &&\
    StartProcess "cmake -S pbrt-v4 -B /usr/local/pbrt" pbrt &&\
    StartProcess "make -C /usr/local/pbrt" pbrt

ENV PATH=$PATH:/usr/local/pbrt
